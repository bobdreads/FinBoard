{% load static %}
<!DOCTYPE html>
<html lang="pt-br" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinBoard - Seu Diário de Trades</title>
    <link href="{% static 'core/css/output.css' %}" rel="stylesheet">
    <link href="{% static 'core/css/home.css' %}" rel="stylesheet">
    {% block extra_head %}
    {% endblock %}
</head>
<body class="bg-CardBackground font-Gilroy">
    <div class="flex flex-col h-screen overflow-hidden relative">
        <header>
            <div class="flex items-center h-[60px] lg:h-[70px] border-b border-solid border-componentBg px-5 bg-background lg:pr-0">
                <div class="flex gap-3 items-center flex-1">
                    <button class=" rounded p-1.5 transition duration-100 flex items-center justify-center outline-none">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-textSecondary size-6">
                            <path d="M3 7H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                            <path d="M3 12H15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                            <path d="M3 17H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                        </svg>
                    </button>
                    <div class="flex items-center space-x-3">
                        <img src="{% static "img/up-arrow.png" %}" class="w-[28px] h-[28px]"></img> 
                        <span class="text-white font-Gilroy font-bold text-3xl">FinBoard</span>
                    </div>
                </div>
                <div class="flex gap-4 items-center h-full">
                    <button class="group flex items-center justify-center bg-primary text-white rounded-lg font-bold w-[35px] h-[35px] hover:w-auto hover:px-4 transition-all duration-300 ease-in-out">
                        <span class="min-w-3">
                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="24" width="24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"></path>
                            </svg>
                        </span>
                        <span class="w-0 overflow-hidden group-hover:w-auto group-hover:ml-2 transition-all duration-300 whitespace-nowrap">
                            Add Trade
                        </span>
                    </button>
                    <button class="group flex items-center justify-center bg-componentBg text-textMain rounded-lg font-bold w-[35px] h-[35px] hover:w-auto hover:px-4 transition-all duration-300 ease-in-out">
                        <span class="min-w-3">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.19 2H7.81C4.17 2 2 4.17 2 7.81V16.18C2 19.83 4.17 22 7.81 22H16.18C19.82 22 21.99 19.83 21.99 16.19V7.81C22 4.17 19.83 2 16.19 2ZM8.18 16.77C8.16 16.77 8.13 16.77 8.11 16.77C7.14 16.68 6.23 16.23 5.55 15.51C3.95 13.83 3.95 11.1 5.55 9.42L7.74 7.12C8.52 6.3 9.57 5.84 10.69 5.84C11.81 5.84 12.86 6.29 13.64 7.12C15.24 8.8 15.24 11.53 13.64 13.21L12.55 14.36C12.26 14.66 11.79 14.67 11.49 14.39C11.19 14.1 11.18 13.63 11.46 13.33L12.55 12.18C13.61 11.07 13.61 9.26 12.55 8.16C11.56 7.12 9.82 7.12 8.82 8.16L6.63 10.46C5.57 11.57 5.57 13.38 6.63 14.48C7.06 14.94 7.64 15.22 8.25 15.28C8.66 15.32 8.96 15.69 8.92 16.1C8.89 16.48 8.56 16.77 8.18 16.77ZM18.45 14.59L16.26 16.89C15.48 17.71 14.43 18.17 13.31 18.17C12.19 18.17 11.14 17.72 10.36 16.89C8.76 15.21 8.76 12.48 10.36 10.8L11.45 9.65C11.74 9.35 12.21 9.34 12.51 9.62C12.81 9.91 12.82 10.38 12.54 10.68L11.45 11.83C10.39 12.94 10.39 14.75 11.45 15.85C12.44 16.89 14.18 16.9 15.18 15.85L17.37 13.55C18.43 12.44 18.43 10.63 17.37 9.53C16.94 9.07 16.36 8.79 15.75 8.73C15.34 8.69 15.04 8.32 15.08 7.91C15.12 7.5 15.48 7.19 15.9 7.24C16.87 7.34 17.78 7.78 18.46 8.5C20.05 10.17 20.05 12.91 18.45 14.59Z" fill="white"></path>
                            </svg>
                        </span>
                        <span class="w-0 overflow-hidden group-hover:w-auto group-hover:ml-2 transition-all duration-300 whitespace-nowrap">
                            Broker connection
                        </span>
                    </button>
                    <div class="bg-[var(--thirdDark)] h-6 w-[1px]"></div>
                    <div class="relative h-full">
                        <button type="button" id="user-menu-button" class="h-full outline-none">
                            <div class="lg:hidden bg-componentBg rounded-lg size-9 flex items-center justify-center text-textMain">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M20.1 9.221c-1.81 0-2.55-1.28-1.65-2.85.52-.91.21-2.07-.7-2.59l-1.73-.99c-.79-.47-1.81-.19-2.28.6l-.11.19c-.9 1.57-2.38 1.57-3.29 0l-.11-.19a1.641 1.641 0 0 0-2.26-.6l-1.73.99c-.91.52-1.22 1.69-.7 2.6.91 1.56.17 2.84-1.64 2.84-1.04 0-1.9.85-1.9 1.9v1.76c0 1.04.85 1.9 1.9 1.9 1.81 0 2.55 1.28 1.64 2.85-.52.91-.21-2.07.7 2.59l1.73.99c.79.47 1.81.19 2.28-.6l.11-.19c.9-1.57 2.38-1.57-3.29 0l.11.19c.47.79 1.49 1.07 2.28.6l1.73-.99c.91-.52 1.22-1.69.7-2.59-.91-1.57-.17-2.85 1.64-2.85 1.04 0 1.9-.85 1.9-1.9v-1.76a1.92 1.92 0 0 0-1.91-1.9Zm-8.1 6.03c-1.79 0-3.25-1.46-3.25-3.25s1.46-3.25 3.25-3.25 3.25 1.46 3.25 3.25-1.46 3.25-3.25 3.25Z" fill="currentColor"></path>
                                </svg>
                            </div>

                            <div class="hidden text-left lg:flex items-center overflow-hidden gap-3 px-6 cursor-pointer hover:bg-componentBg h-full min-w-[320px] max-w-[320px]">
                                <div class="truncate flex-1">
                                    <div class="font-bold text-textMain truncate">zezinho@gmail.com</div>
                                    <div><span class="font-medium text-sm text-[var(--textSecondary)]">FinBoard Pro</span></div>
                                </div>
                                <svg id="user-menu-arrow" class="transition-transform duration-300 text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path fill="currentColor" d="M17.919 8.18H6.079c-.96 0-1.44 1.16-.76 1.84l5.18 5.18c.83.83 2.18.83 3.01 0l1.97-1.97 3.21-3.21c.67-.68.19-1.84-.77-1.84z"></path>
                                </svg>
                            </div>
                        </button>

                        <div id="user-menu" class="absolute top-full right-0 w-[320px] bg-componentBg rounded-b-lg shadow-lg overflow-hidden opacity-0 pointer-events-none transform -translate-y-2 transition-all duration-300 ease-in-out z-10">

                            <a href="#" class="flex items-center gap-4 hover:bg-thirdDark text-textMain py-3 px-4 cursor-pointer transition-colors duration-150">
                                <div><svg class="size-6 text-textSecondary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" /></svg></div>
                                <div class="font-medium flex-1">Meu Perfil</div>
                            </a>
                            <a href="#" class="flex items-center gap-4 hover:bg-thirdDark text-textMain py-3 px-4 cursor-pointer transition-colors duration-150">
                                <div><svg class="size-6 text-textSecondary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" /></svg></div>
                                <div class="font-medium flex-1">Configurações</div>
                            </a>
                            <div class="border-t border-solid border-t-[var(--thirdDark)] my-2"></div>
                            <a href="#" class="flex items-center gap-4 hover:bg-thirdDark text-textMain py-3 px-4 cursor-pointer transition-colors duration-150">
                                <div><svg class="size-6 text-textSecondary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3v12" /></svg></div>
                                <div class="font-medium flex-1">Exportar Extrato</div>
                            </a>
                            <div class="border-t border-solid border-t-[var(--thirdDark)] my-2"></div>
                            <a href="#" class="flex items-center gap-4 hover:bg-thirdDark text-red-500 py-3 px-4 cursor-pointer transition-colors duration-150">
                                <div><svg class="size-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" /></svg></div>
                                <div class="font-medium flex-1">Sair</div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="flex flex-1 overflow-hidden">
            <aside class="bg-background w-[250px] min-h-full border-r border-componentBg flex flex-col p-5 gap-5">
                <!-- Botão Portfolio -->
                <button id="portfolio-btn" class="flex items-center justify-between px-4 py-2 bg-componentBg rounded-lg text-textMain font-semibold w-full">
                    Portfolio
                    <svg id="portfolio-arrow" class="w-4 h-4 transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                </button>
            </aside>

            <main class="flex-1 p-6 bg-CardBackground overflow-auto">
                {% block content %}
                <!-- Conteúdo da Main -->
                {% endblock %}
            </main>
        </div>

        <!-- DROPDOWN PORTFOLIO -->
        <div id="portfolio-menu" class="absolute bg-componentBg rounded-lg mt-2 shadow-lg opacity-0 pointer-events-none transform -translate-y-2 transition-all duration-300 ease-in-out z-50 w-80">
            <div class="flex items-center justify-between px-4 py-2 border-b border-componentBg">
                <span class="font-semibold text-textMain">Portfolios</span>
                <button class="bg-thirdDark text-textMain text-sm font-medium px-3 py-1 rounded-lg hover:opacity-80">+ New Portfolio</button>
            </div>
            <div class="p-2">
                <div class="flex items-center justify-between px-3 py-2 rounded-md hover:bg-thirdDark cursor-pointer">
                    <div class="flex items-center space-x-2">
                        <input type="checkbox" checked class="form-checkbox accent-mainColor">
                        <span class="w-2 h-2 rounded-full bg-mainColor"></span>
                        <span class="text-textMain font-medium">Default Portfolio</span>
                    </div>
                    <span class="text-textSecondary text-sm">-0.21</span>
                </div>
                <!-- Mais items aqui -->
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    {{ form.media.js }}
    <script>
        const userMenuButton = document.getElementById('user-menu-button');
        const userMenu = document.getElementById('user-menu');
        const userMenuArrow = document.getElementById('user-menu-arrow');

        // ABRIR
        const openMenu = () => {
            userMenu.classList.remove('opacity-0', '-translate-y-2', 'pointer-events-none');
            userMenuArrow.classList.add('rotate-180');
        };

        // FECHAR
        const closeMenu = () => {
            userMenu.classList.add('opacity-0', '-translate-y-2', 'pointer-events-none');
            userMenuArrow.classList.remove('rotate-180');
        };

        // TOGGLE ao clicar no botão
        userMenuButton.addEventListener('click', (event) => {
            event.stopPropagation(); // impede o clique de subir
            const isClosed = userMenu.classList.contains('opacity-0');
            isClosed ? openMenu() : closeMenu();
        });

        // Evita que cliques dentro do menu fechem ele
        userMenu.addEventListener('click', (event) => {
            event.stopPropagation();
        });

        // Fecha ao clicar fora
        document.addEventListener('click', (event) => {
            const isOpen = !userMenu.classList.contains('opacity-0');
            if (isOpen) {
                closeMenu();
            }
        });

        // Fecha com ESC
        window.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && !userMenu.classList.contains('opacity-0')) {
                closeMenu();
            }
        });

         const btn = document.getElementById("portfolio-btn");
        const menu = document.getElementById("portfolio-menu");
        const arrow = document.getElementById("portfolio-arrow");

        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            const rect = btn.getBoundingClientRect();
            menu.style.top = `${rect.bottom + window.scrollY}px`;
            menu.style.left = `${rect.left + window.scrollX}px`;

            menu.classList.toggle("opacity-0");
            menu.classList.toggle("pointer-events-none");
            menu.classList.toggle("-translate-y-2");
            arrow.classList.toggle("rotate-180");
        });

        document.addEventListener("click", () => {
            if (!menu.classList.contains("opacity-0")) {
                menu.classList.add("opacity-0", "pointer-events-none", "-translate-y-2");
                arrow.classList.remove("rotate-180");
            }
        });

        menu.addEventListener("click", (e) => e.stopPropagation());
    </script>

    <script src="{% static 'core/js/main.bundle.js' %}"></script> 
</body>
</html>